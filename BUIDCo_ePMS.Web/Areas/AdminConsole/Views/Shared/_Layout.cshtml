@using Microsoft.AspNetCore.Http;
@inject IHttpContextAccessor HttpContextAccessor
@inject Microsoft.AspNetCore.Hosting.IHostingEnvironment hostingEnv

@{
    var request = HttpContextAccessor.HttpContext.Request;

    var absoluteUri = string.Concat(
                request.Scheme,
                "://",
                request.Host.ToUriComponent());
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <title>BUIDCO Admin Console @hostingEnv.EnvironmentName</title>

    <environment include="Development,Staging,Production">
        <link rel="shortcut icon" href="#" type="image/x-icon">
        <link href="~/AdminConsole/css/bootstrap.min.css" rel="stylesheet">
        <link href="~/AdminConsole/css/icons.css" rel="stylesheet">
        <link href="~/AdminConsole/css/custom.css" rel="stylesheet">
        @*<link href="~/AdminConsole/css/login.css" rel="stylesheet">
        <link href="~/AdminConsole/css/dashboard.css" rel="stylesheet">*@
        <link href="~/AdminConsole/css/bootstrap-datepicker.min.css" rel="stylesheet">
        @*<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/4.4.0/bootbox.min.js"></script>*@
        <link href="~/AdminConsole/css/slimscrollbar.min.css" rel="stylesheet">
        <link href="~/AdminConsole/css/font-awesome.min.css" rel="stylesheet">
        <link rel="icon" type="image/x-icon" href="~/Images/logo.png" />
    </environment>

</head>
<body>
    <!--  ====HEADER====  -->
    <header>
        <nav class="navbar">
            <!-- Navbar brand -->
            <a class="navbar-brand" href="dashboard.php">
                <a class="nav-toggle-btn">
                    <span></span>

                </a>
                <h5 class="text-white"><i>Admin Console <span class="yellow">(core)</span></i></h5>
            </a>
            <div class="navbar-collapse justify-content-end collapse">
                <ul class="navbar-nav">


                    <!--<li class="nav-item dropdown">
                      <a class="nav-link dropdown-toggle welcome"  href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Welcome to <br>@HttpContextAccessor.HttpContext.Session.GetString("UserName")
                      </a>
                      <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <a asp-controller="Home" asp-action="ChangePassword" tabindex="0" class="dropdown-item">Change Password</a>
                        <a asp-controller="Home" asp-action="UpdateProfile" tabindex="0" class="dropdown-item">Update Profile</a>
                      </div>
                    </li>-->

                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle welcome" href="Javascript:void(0);" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <br>
                            @HttpContextAccessor.HttpContext.Session.GetString("VCHFULLNAME")
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                            <a asp-controller="Home" asp-action="ChangePassword" tabindex="0" class="dropdown-item">Change Password</a>
                            <a asp-controller="Home" asp-action="UpdateProfile" tabindex="0" class="dropdown-item">Update Profile</a>
                        </div>
                    </li>
                    <li class="nav-item"><a class="nav-link logout" href="Javascript:void(0);"><i class="icon-log-out1"></i></a></li>

                </ul>
            </div>
        </nav>
    </header>
    <!--  ====HEADER====  -->
    <!--  ====LOGOUT MODAL====  -->
    <div class="logout-modal">
        <div class="logou-container text-center">
            <div class="container">
                <h3>Do you really want to log out?</h3>
                @*<a class="btn btn-mint">Yes</a>*@
                <a asp-area="AdminConsole" asp-controller="Home" asp-action="Logout" class="btn btn-mint">Yes</a>
                <a class="btn btn-danger nologout">No</a>
            </div>
        </div>
    </div>
    <!--  ====LOGOUT MODAL====  -->
    <!--===Side Menu===-->
    <div class="page-container">
        <div class="sidemenu">
            <div class="clearfix">
            </div>
            <nav class="navbar">
                <div class="navbar-collapse justify-content-end" id="basicExampleNav">
                    <ul class="navbar-nav">

                        <li class="nav-item dropdown tcomp">
                            <a class="nav-link dropdown-toggle" id="navbarDropdownMenuLink" data-toggle="dropdown"
                               aria-haspopup="true" aria-expanded="false"><i class="icon-user1"></i><span>Manage Master</span></a>
                            <div class="dropdown-menu tcomp" aria-labelledby="navbarDropdownMenuLink">
                                <a class="dropdown-item comreg" asp-controller="HierarchyMaster" asp-action="AddHirerarchy">Hierarchy Master</a>
                                <a class="dropdown-item comreg1" asp-controller="LevelMaster" asp-action="AddLevelMaster">Level  Master</a>
                                <a class="dropdown-item comreg" asp-controller="LevelDetailsMaster" asp-action="AddLevelDetailsMaster">Level Details Master</a>
                                <a class="dropdown-item comreg" asp-controller="DesignationMaster" asp-action="AddDesignationMaster">Designation Master</a>
                                <a class="dropdown-item comreg1" asp-controller="FunctionMaster" asp-action="AddFunctionMaster">Function Master</a>
                                @* <a class="dropdown-item comreg1" asp-controller="EmailMaster"  asp-action="AddEmailMaster">Email Configuration</a> *@
                            </div>
                        </li>
                        <li class="nav-item dropdown tcomp">
                            <a class="nav-link dropdown-toggle" id="navbarDropdownMenuLink" data-toggle="dropdown"
                               aria-haspopup="true" aria-expanded="false"><i class="fa fa-list-ul" aria-hidden="true"></i><span>Manage Menu</span></a>
                            <div class="dropdown-menu tcomp" aria-labelledby="navbarDropdownMenuLink">
                                <a class="dropdown-item comreg" asp-controller="ProjectLink" asp-action="AddProjectLink">Project Link</a>
                                @*<a class="dropdown-item comreg" asp-controller="ButtonMaster" asp-action="ButtonTabb">Button</a>
                                <a class="dropdown-item comreg" asp-controller="TabMaster" asp-action="AddTabb">Tab</a>*@
                                <a class="dropdown-item comreg" asp-controller="GlobalLink" asp-action="AddGlobalLink">Global Link</a>
                                <a class="dropdown-item comreg1" asp-controller="PrimaryLink" asp-action="AddPrimaryLink">Primary Link</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown tcomp">
                            <a class="nav-link dropdown-toggle" id="navbarDropdownMenuLink" data-toggle="dropdown"
                               aria-haspopup="true" aria-expanded="false"><i class="fa fa-users" aria-hidden="true"></i><span>Manage User</span></a>
                            <div class="dropdown-menu tcomp" aria-labelledby="navbarDropdownMenuLink">
                                <a class="dropdown-item comreg" asp-controller="User" asp-action="AddUser">Create New User</a>
                                @*<a class="dropdown-item comreg1" asp-controller="User" asp-action="ViewUser">View User List</a>*@
                                <a class="dropdown-item comreg" asp-controller="SetPermission" asp-action="SetPermission">Set User Permission</a>
                                <a class="dropdown-item comreg1" asp-controller="SetPermission" asp-action="ViewUser">Remove User Permission</a>
                            </div>
                        </li>
                        @*<li class="nav-item dropdown tcomp">
                                <a class="nav-link dropdown-toggle" id="navbarDropdownMenuLink" data-toggle="dropdown"
                                   aria-haspopup="true" aria-expanded="false"><i class="fa fa-users" aria-hidden="true"></i><span>Other Apps</span></a>
                                <div class="dropdown-menu tcomp" aria-labelledby="navbarDropdownMenuLink">
                                    <a href="https://sdb.csmpl.com/Login/IntermediateLogin?UserName=@HttpContextAccessor.HttpContext.Session.GetString("_EncryptUserName")" class="dropdown-item comreg" target="_blank"> Citizen Portal  </a>
                                    <a href="https://5tsd.csmpl.com/Login/IntermediateLogin?UserName=@HttpContextAccessor.HttpContext.Session.GetString("_EncryptUserName")" class="dropdown-item comreg" target="_blank"> 5T Portal  </a>
                                    <a href="https://sdg.csmpl.com/Login/IntermediateLogin?UserName=@HttpContextAccessor.HttpContext.Session.GetString("_EncryptUserName")" class="dropdown-item comreg" target="_blank"> SDG Portal  </a>
                                </div>
                            </li>*@
                    </ul>
                </div>
            </nav>
        </div>
        <!--===Side Menu===-->
        <!------------------ Main Container Starts ---------------->
        <div class="mainpanel">
            <!-- Cards -->
            <partial name="_CookieConsentPartial" />

            @RenderBody()

            <!-- Card Ends -->
        </div>
    </div>
    <!------------------ Main Container Ends ------------------>
    <!---------------------- Footer Starts -------------------->
    <footer class="page-footer no-padding white blue-text hide">
        <div class="footer-copyright">
            <div class="container">
                &copy; 2019 All right reserved
                <a class="right" href="javascript:void(0);">Developed by CSM</a>
            </div>
        </div>
    </footer>
    <!----------------------- Footer Ends --------------------->


    <environment include="Development,Staging,Production">
        <link href="~/AdminConsole/css/bootstrap-datepicker.min.css" rel="stylesheet">
        <script src="~/AdminConsole/js/jquery-3.3.1.min.js"></script>
        <script src="~/AdminConsole/js/popper.min.js"></script>
        <script src="~/AdminConsole/js/bootstrap.min.js"></script>
        <script src="~/AdminConsole/js/bootstrap-datepicker.min.js"></script>
        <script src="~/AdminConsole/js/chartist.min.js"></script>

        <script src="~/AdminConsole/js/slimscrollbar.min.js"></script>
        <script src="~/AdminConsole/js/custom.js"></script>
        <script src="~/AdminConsole/js/jquery.dataTables.min.js"></script>
        <script src="~/AdminConsole/js/dataTables.bootstrap4.min.js"></script>
        <link href="~/AdminConsole/css/dataTables.bootstrap4.min.css" rel="stylesheet" />
        <link href="~/AdminConsole/css/bootstrap-datepicker.min.css" rel="stylesheet" />
        <script src="~/js/bootbox.js"></script>
        <script type="text/javascript">
            function preventBack() { window.history.forward(); }
            setTimeout("preventBack()", 0);
            window.onunload = function () { null; };
        </script>
        <script type="text/javascript" language="javascript">
            function DisableBackButton() {
                window.history.forward();
            }
            DisableBackButton();
            window.onload = DisableBackButton;
            window.onpageshow = function (evt) { if (evt.persisted) DisableBackButton(); }
            window.onunload = function () { void (0); };
        </script>
    </environment>


    @RenderSection("Scripts", required: false)
    @*<script src="https://ssosd.csmpl.com:8443/auth/js/keycloak.js?version=jg16k"></script>*@
</body>
</html>









@*<script>
        //sender

        $(document).ready(function () {
            $("#globalLogout").click(function () {
                $.get("@absoluteUri/Home/SimpleLogout", function (data, status) {
                    location.href = "@absoluteUri";
                });
            });
        });
        //sender

        $(document).ready(function () {
                var keycloak = new Keycloak({
                    url: 'https://ssosd.csmpl.com:8443/auth',
                    realm: 'master',
                    clientId: '@Configuration["Authentication:oidc:ClientId"]'
                });


                keycloak.onAuthLogout = function () {
                    $.get("/Home/SimpleLogout", function (data, status) {
                        location.reload();
                    });

                    console.log('someone has logged out somewhere');
                }

                //keycloak.init({
                //    onLoad: 'login-required'
                //})

                keycloak.init({
                    onLoad: 'check-sso',
                    silentCheckSsoRedirectUri: window.location.origin + '/silent-check-sso.html'
                })

                //keycloak.init().then(function (authenticated) {
                //    console.log(authenticated ? 'authenticated' : 'not authenticated');
                //}).catch(function () {
                //    console.log('failed to initialize');
                //});


            });

        //Reciever
    </script>*@

